{"version":3,"sources":["methods.android.ts"],"names":["NativeModule","NativeModules","RNPermissions","openSettings","check","permission","checkPermission","request","rationale","shouldShowRationale","shouldShowRequestPermissionRationale","title","message","buttonPositive","buttonNegative","buttonNeutral","Promise","resolve","buttons","onPress","push","text","requestPermission","Alert","alert","cancelable","checkNotifications","checkMultiple","permissions","dedup","checkMultiplePermissions","requestMultiple","requestMultiplePermissions","methods","checkLocationAccuracy","openLimitedPhotoLibraryPicker","requestLocationAccuracy","requestNotifications"],"mappings":";;;;;;;AAAA;;AAGA;;AAKA;;AAEA,MAAMA,YAaL,GAAGC,2BAAcC,aAblB;;AAeA,eAAeC,YAAf,GAA6C;AAC3C,QAAMH,YAAY,CAACG,YAAb,EAAN;AACD;;AAED,SAASC,KAAT,CAAeC,UAAf,EAAkE;AAChE,SAAOL,YAAY,CAACM,eAAb,CAA6BD,UAA7B,CAAP;AACD;;AAED,eAAeE,OAAf,CAAuBF,UAAvB,EAA+CG,SAA/C,EAAiG;AAC/F,MAAIA,SAAJ,EAAe;AACb,UAAMC,mBAAmB,GAAG,MAAMT,YAAY,CAACU,oCAAb,CAAkDL,UAAlD,CAAlC;;AAEA,QAAII,mBAAJ,EAAyB;AACvB,YAAM;AAACE,QAAAA,KAAD;AAAQC,QAAAA,OAAR;AAAiBC,QAAAA,cAAjB;AAAiCC,QAAAA,cAAjC;AAAiDC,QAAAA;AAAjD,UAAkEP,SAAxE;AAEA,aAAO,IAAIQ,OAAJ,CAAaC,OAAD,IAAa;AAC9B,cAAMC,OAAsB,GAAG,EAA/B;;AAEA,YAAIJ,cAAJ,EAAoB;AAClB,gBAAMK,OAAO,GAAG,MAAMF,OAAO,CAACjB,YAAY,CAACM,eAAb,CAA6BD,UAA7B,CAAD,CAA7B;;AACAU,UAAAA,aAAa,IAAIG,OAAO,CAACE,IAAR,CAAa;AAACC,YAAAA,IAAI,EAAEN,aAAP;AAAsBI,YAAAA;AAAtB,WAAb,CAAjB;AACAD,UAAAA,OAAO,CAACE,IAAR,CAAa;AAACC,YAAAA,IAAI,EAAEP,cAAP;AAAuBK,YAAAA;AAAvB,WAAb;AACD;;AAEDD,QAAAA,OAAO,CAACE,IAAR,CAAa;AACXC,UAAAA,IAAI,EAAER,cADK;AAEXM,UAAAA,OAAO,EAAE,MAAMF,OAAO,CAACjB,YAAY,CAACsB,iBAAb,CAA+BjB,UAA/B,CAAD;AAFX,SAAb;;AAKAkB,2BAAMC,KAAN,CAAYb,KAAZ,EAAmBC,OAAnB,EAA4BM,OAA5B,EAAqC;AAACO,UAAAA,UAAU,EAAE;AAAb,SAArC;AACD,OAfM,CAAP;AAgBD;AACF;;AAED,SAAOzB,YAAY,CAACsB,iBAAb,CAA+BjB,UAA/B,CAAP;AACD;;AAED,SAASqB,kBAAT,GAA8D;AAC5D,SAAO1B,YAAY,CAAC0B,kBAAb,EAAP;AACD;;AAED,SAASC,aAAT,CACEC,WADF,EAEgD;AAC9C,QAAMC,KAAK,GAAG,iBAAKD,WAAL,CAAd;AACA,SAAO5B,YAAY,CAAC8B,wBAAb,CAAsCD,KAAtC,CAAP;AACD;;AAED,SAASE,eAAT,CACEH,WADF,EAEgD;AAC9C,QAAMC,KAAK,GAAG,iBAAKD,WAAL,CAAd;AACA,SAAO5B,YAAY,CAACgC,0BAAb,CAAwCH,KAAxC,CAAP;AACD;;AAEM,MAAMI,OAAiB,GAAG;AAC/B7B,EAAAA,KAD+B;AAE/B8B,EAAAA,qBAAqB,EAArBA,iDAF+B;AAG/BP,EAAAA,aAH+B;AAI/BD,EAAAA,kBAJ+B;AAK/BS,EAAAA,6BAA6B,EAA7BA,yDAL+B;AAM/BhC,EAAAA,YAN+B;AAO/BI,EAAAA,OAP+B;AAQ/B6B,EAAAA,uBAAuB,EAAvBA,mDAR+B;AAS/BL,EAAAA,eAT+B;AAU/BM,EAAAA,oBAAoB,EAAEX;AAVS,CAA1B","sourcesContent":["import {Alert, AlertButton, NativeModules} from 'react-native';\nimport type {Contract} from './contract';\nimport type {NotificationsResponse, Permission, PermissionStatus, Rationale} from './types';\nimport {\n  checkLocationAccuracy,\n  openLimitedPhotoLibraryPicker,\n  requestLocationAccuracy,\n} from './unsupportedPlatformMethods';\nimport {uniq} from './utils';\n\nconst NativeModule: {\n  checkPermission: (permission: Permission) => Promise<PermissionStatus>;\n  requestPermission: (permission: Permission) => Promise<PermissionStatus>;\n  checkNotifications: () => Promise<NotificationsResponse>;\n  openSettings: () => Promise<true>;\n  shouldShowRequestPermissionRationale: (permission: Permission) => Promise<boolean>;\n\n  checkMultiplePermissions: (\n    permissions: Permission[],\n  ) => Promise<Record<Permission, PermissionStatus>>;\n  requestMultiplePermissions: (\n    permissions: Permission[],\n  ) => Promise<Record<Permission, PermissionStatus>>;\n} = NativeModules.RNPermissions;\n\nasync function openSettings(): Promise<void> {\n  await NativeModule.openSettings();\n}\n\nfunction check(permission: Permission): Promise<PermissionStatus> {\n  return NativeModule.checkPermission(permission);\n}\n\nasync function request(permission: Permission, rationale?: Rationale): Promise<PermissionStatus> {\n  if (rationale) {\n    const shouldShowRationale = await NativeModule.shouldShowRequestPermissionRationale(permission);\n\n    if (shouldShowRationale) {\n      const {title, message, buttonPositive, buttonNegative, buttonNeutral} = rationale;\n\n      return new Promise((resolve) => {\n        const buttons: AlertButton[] = [];\n\n        if (buttonNegative) {\n          const onPress = () => resolve(NativeModule.checkPermission(permission));\n          buttonNeutral && buttons.push({text: buttonNeutral, onPress});\n          buttons.push({text: buttonNegative, onPress});\n        }\n\n        buttons.push({\n          text: buttonPositive,\n          onPress: () => resolve(NativeModule.requestPermission(permission)),\n        });\n\n        Alert.alert(title, message, buttons, {cancelable: false});\n      });\n    }\n  }\n\n  return NativeModule.requestPermission(permission);\n}\n\nfunction checkNotifications(): Promise<NotificationsResponse> {\n  return NativeModule.checkNotifications();\n}\n\nfunction checkMultiple<P extends Permission[]>(\n  permissions: P,\n): Promise<Record<P[number], PermissionStatus>> {\n  const dedup = uniq(permissions);\n  return NativeModule.checkMultiplePermissions(dedup);\n}\n\nfunction requestMultiple<P extends Permission[]>(\n  permissions: P,\n): Promise<Record<P[number], PermissionStatus>> {\n  const dedup = uniq(permissions);\n  return NativeModule.requestMultiplePermissions(dedup);\n}\n\nexport const methods: Contract = {\n  check,\n  checkLocationAccuracy,\n  checkMultiple,\n  checkNotifications,\n  openLimitedPhotoLibraryPicker,\n  openSettings,\n  request,\n  requestLocationAccuracy,\n  requestMultiple,\n  requestNotifications: checkNotifications,\n};\n"]}